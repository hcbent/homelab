---
# Service restart and health verification tasks
- name: Stop Elasticsearch service
  service:
    name: "{{ elasticsearch_service }}"
    state: stopped

- name: Start Elasticsearch service
  service:
    name: "{{ elasticsearch_service }}"
    state: started
  register: es_start

- name: Wait for node to join cluster
  wait_for:
    host: "{{ inventory_hostname }}"
    port: "{{ elasticsearch_port }}"
    timeout: "{{ node_startup_timeout }}"