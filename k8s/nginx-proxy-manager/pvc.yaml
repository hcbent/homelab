---
# PVC for nginx-proxy-manager data
# Protected from ArgoCD pruning with annotations and finalizers
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: nginx-proxy-manager-data
  namespace: nginx-proxy-manager
  labels:
    app.kubernetes.io/name: nginx-proxy-manager
    app.kubernetes.io/component: storage
  annotations:
    # Prevent ArgoCD from deleting this PVC during sync/prune operations
    argocd.argoproj.io/sync-options: Prune=false
  finalizers:
    # Kubernetes built-in protection - prevents deletion while in use
    - kubernetes.io/pvc-protection
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: freenas-iscsi-csi
  resources:
    requests:
      storage: 1Gi
---
# PVC for Let's Encrypt certificates
# Protected from ArgoCD pruning with annotations and finalizers
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: nginx-proxy-manager-letsencrypt
  namespace: nginx-proxy-manager
  labels:
    app.kubernetes.io/name: nginx-proxy-manager
    app.kubernetes.io/component: storage
  annotations:
    # Prevent ArgoCD from deleting this PVC during sync/prune operations
    argocd.argoproj.io/sync-options: Prune=false
  finalizers:
    # Kubernetes built-in protection - prevents deletion while in use
    - kubernetes.io/pvc-protection
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: freenas-iscsi-csi
  resources:
    requests:
      storage: 1Gi
