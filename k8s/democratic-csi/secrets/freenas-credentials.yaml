---
# Kubernetes Secret for FreeNAS/TrueNAS credentials
# This secret will be populated from Vault using external-secrets or manually created
apiVersion: v1
kind: Secret
metadata:
  name: freenas-credentials
  namespace: democratic-csi
type: Opaque
stringData:
  # TrueNAS API credentials
  api-key: ""  # Populate from Vault: vault kv get secret/homelab/freenas/api-key
  password: ""  # Populate from Vault: vault kv get secret/homelab/freenas/password

  # SSH credentials (base64 encoded)
  ssh-private-key: ""  # Populate from Vault: vault kv get secret/homelab/freenas/ssh-key
---
# Example using Vault CSI Provider (alternative approach)
# This uses the Vault CSI driver to automatically sync secrets
apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: freenas-vault-secrets
  namespace: democratic-csi
spec:
  provider: vault
  parameters:
    roleName: "democratic-csi"
    vaultAddress: "http://vault.vault.svc.cluster.local:8200"
    objects: |
      - objectName: "api-key"
        secretPath: "secret/data/homelab/freenas"
        secretKey: "api-key"
      - objectName: "password"
        secretPath: "secret/data/homelab/freenas"
        secretKey: "password"
      - objectName: "ssh-private-key"
        secretPath: "secret/data/homelab/freenas"
        secretKey: "ssh-private-key"
  secretObjects:
  - secretName: freenas-credentials
    type: Opaque
    data:
    - objectName: api-key
      key: api-key
    - objectName: password
      key: password
    - objectName: ssh-private-key
      key: ssh-private-key
