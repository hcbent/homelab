# Kubespray Kubernetes Cluster Infrastructure Configuration (EXAMPLE)
# Copy this file to terraform.tfvars and customize with your values

# Proxmox API configuration
# Credentials are retrieved from Vault at secret/homelab/proxmox/terraform
pm_api_url      = "https://pve1.lab.thewortmans.org:8006/api2/json"
pm_tls_insecure = true

# Cloud-init configuration
# User credentials are retrieved from Vault (cipassword)
ciuser = "bret"

# SSH public key for access
# Replace with your SSH public key
sshkeys = "ssh-rsa AAAAB... your-key-here"

# Control Plane VMs (km02, km03)
# Note: km01 (192.168.10.234) is bare metal and not provisioned by Terraform
control_plane_vms = [
  {
    name           = "km02"
    target_node    = "pve1"
    vmid           = "221"
    clone          = "ubuntu-25.04"
    os_type        = "linux"
    cores          = "4"
    memory         = "8192"
    sockets        = "1"
    disk_size      = "100G"
    disk_storage   = "tank"
    network_model  = "virtio"
    network_bridge = "vmbr0"
    tags           = "kubespray,control-plane"
    ipconfig0      = "ip=192.168.10.235/24,gw=192.168.10.1"
  },
  {
    name           = "km03"
    target_node    = "pve2"
    vmid           = "222"
    clone          = "ubuntu-25.04"
    os_type        = "linux"
    cores          = "4"
    memory         = "8192"
    sockets        = "1"
    disk_size      = "100G"
    disk_storage   = "tank"
    network_model  = "virtio"
    network_bridge = "vmbr0"
    tags           = "kubespray,control-plane"
    ipconfig0      = "ip=192.168.10.236/24,gw=192.168.10.1"
  }
]

# Worker VMs (kube01-kube03)
worker_vms = [
  {
    name           = "kube01"
    target_node    = "pve3"
    vmid           = "223"
    clone          = "ubuntu-25.04"
    os_type        = "linux"
    cores          = "8"
    memory         = "16384"
    sockets        = "1"
    disk_size      = "200G"
    disk_storage   = "tank"
    network_model  = "virtio"
    network_bridge = "vmbr0"
    tags           = "kubespray,worker"
    ipconfig0      = "ip=192.168.10.237/24,gw=192.168.10.1"
  },
  {
    name           = "kube02"
    target_node    = "pve1"
    vmid           = "224"
    clone          = "ubuntu-25.04"
    os_type        = "linux"
    cores          = "8"
    memory         = "16384"
    sockets        = "1"
    disk_size      = "200G"
    disk_storage   = "tank"
    network_model  = "virtio"
    network_bridge = "vmbr0"
    tags           = "kubespray,worker"
    ipconfig0      = "ip=192.168.10.238/24,gw=192.168.10.1"
  },
  {
    name           = "kube03"
    target_node    = "pve2"
    vmid           = "225"
    clone          = "ubuntu-25.04"
    os_type        = "linux"
    cores          = "8"
    memory         = "16384"
    sockets        = "1"
    disk_size      = "200G"
    disk_storage   = "tank"
    network_model  = "virtio"
    network_bridge = "vmbr0"
    tags           = "kubespray,worker"
    ipconfig0      = "ip=192.168.10.239/24,gw=192.168.10.1"
  }
]
